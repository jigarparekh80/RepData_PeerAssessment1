---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

```{r}
unzip("activity.zip")
data<-read.csv("activity.csv",header = TRUE)
```


## What is mean total number of steps taken per day?

```{r}
#Make a histogram of the total number of steps taken each day

library(data.table)
activity <- data.table(data)
activity.totalSteps<-activity[,sum(steps,na.rm = TRUE),by=date]
hist(activity.totalSteps$V1,breaks=10,main="Histogram of total steps per day over two months",
     xlab="Total steps per day")

#Calculate and report the mean and median total number of steps taken per day

activity.mean=mean(activity.totalSteps$V1,na.rm = TRUE)
activity.median = median(activity.totalSteps$V1,na.rm = TRUE)
```
mean =  `r activity.mean`

median = `r activity.median`


## What is the average daily activity pattern?

```{r}
#Make a time series plot (i.e. type = "l") of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)

activity.totalStepsInterval <- activity[,mean(steps,na.rm = TRUE),by=interval]
plot(activity.totalStepsInterval$interval,activity.totalStepsInterval$V1, type = 'l',xlab='Time Interval of 5 Min',ylab="Average number of steps taken")

```


```{r}
#Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?

maxSteps<-activity.totalStepsInterval[which.max(activity.totalStepsInterval$V1)]

```

Maximum number of steps: `r maxSteps$V1`

Time Interval for maximum number of steps: `r maxSteps$interval`



## Imputing missing values
```{r}
bad<-is.na(activity$steps)
totalNA<-sum(bad)

activity.meanStepsDay<-activity[,mean(steps,na.rm = TRUE),by=date]
bad2 <- is.nan(activity.meanStepsDay$V1)
activity.meanStepsDay$V1[bad2] <- 0

```
Total number of rows with NAs: `r totalNA`


## Are there differences in activity patterns between weekdays and weekends?
